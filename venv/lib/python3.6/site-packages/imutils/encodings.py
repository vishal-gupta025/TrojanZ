import numpy as np
import base64
import json
import sys

def base64_encode_image(a):
	
	return json.dumps([base64_encode_array(a).decode("utf-8"), str(a.dtype),
		a.shape])

def base64_decode_image(a):
	(a, dtype, shape) = json.loads(a)


	if sys.version_info.major == 3:
		a = bytes(a, encoding="utf-8")

	a = base64_decode_array(a, dtype).reshape(shape)

	return a

def base64_encode_array(a):
	return base64.b64encode(a)

def base64_decode_array(a, dtype):
	return np.frombuffer(base64.decodestring(a), dtype=dtype)